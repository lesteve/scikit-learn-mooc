
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Using numerical and categorical variables together &#8212; Scikit-learn course</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sklearn_mooc.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sklearn_mooc.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="📝 Exercise M1.05" href="03_categorical_pipeline_ex_02.html" />
    <link rel="prev" title="📃 Solution for Exercise M1.04" href="03_categorical_pipeline_sol_01.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/scikit-learn-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Scikit-learn course</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Machine Learning Concepts
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ml_concepts/slides.html">
   📰 Introducing machine-learning concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ml_concepts/quiz_intro_01.html">
   ✅ Quiz Intro.01
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The predictive modeling pipeline
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../predictive_modeling_pipeline/predictive_modeling_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../predictive_modeling_pipeline/01_tabular_data_exploration_index.html">
   Tabular data exploration
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="01_tabular_data_exploration.html">
     First look at our dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01_tabular_data_exploration_ex_01.html">
     📝 Exercise M1.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01_tabular_data_exploration_sol_01.html">
     📃 Solution for Exercise M1.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../predictive_modeling_pipeline/01_tabular_data_exploration_quiz_m1_01.html">
     ✅ Quiz M1.01
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../predictive_modeling_pipeline/02_numerical_pipeline_index.html">
   Fitting a scikit-learn model on numerical data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_introduction.html">
     First model with scikit-learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_ex_00.html">
     📝 Exercise M1.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_sol_00.html">
     📃 Solution for Exercise M1.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_hands_on.html">
     Working with numerical data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_ex_01.html">
     📝 Exercise M1.03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_sol_01.html">
     📃 Solution for Exercise M1.03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_scaling.html">
     Preprocessing for numerical features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../predictive_modeling_pipeline/02_numerical_pipeline_quiz_m1_02.html">
     ✅ Quiz M1.02
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../predictive_modeling_pipeline/03_categorical_pipeline_index.html">
   Handling categorical data
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="03_categorical_pipeline.html">
     Encoding of categorical variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_categorical_pipeline_ex_01.html">
     📝 Exercise M1.04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_categorical_pipeline_sol_01.html">
     📃 Solution for Exercise M1.04
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Using numerical and categorical variables together
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_categorical_pipeline_ex_02.html">
     📝 Exercise M1.05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_categorical_pipeline_sol_02.html">
     📃 Solution for Exercise M1.05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../predictive_modeling_pipeline/03_categorical_pipeline_quiz_m1_03.html">
     ✅ Quiz M1.03
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../predictive_modeling_pipeline/wrap_up_quiz.html">
   🏁 Wrap-up quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../predictive_modeling_pipeline/predictive_modeling_module_take_away.html">
   Main take-away
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Selecting the best model
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../overfit/overfit_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../overfit/overfit_overfitting_underfitting_index.html">
   Overfitting and underfitting
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../overfit/overfitting_vs_under_fitting_slides.html">
     📰 Overfitting and Underfitting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_train_test.html">
     The framework and why do we need it
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../overfit/overfitting_vs_under_fitting_quiz_m2_01.html">
     ✅ Quiz M2.01
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../overfit/overfit_validation_learning_curves_index.html">
   Validation and learning curves
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../overfit/learning_validation_curves_slides.html">
     📰 Comparing train and test errors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_validation_curve.html">
     Overfit-generalization-underfit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_learning_curve.html">
     Effect of the sample size in cross-validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_ex_01.html">
     📝 Exercise M2.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_sol_01.html">
     📃 Solution for Exercise M2.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../overfit/learning_validation_curves_quiz_m2_02.html">
     ✅ Quiz M2.02
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../overfit/overfit_bias_variance_index.html">
   Bias versus variance trade-off
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../overfit/bias_vs_variance_slides.html">
     📰 Bias versus Variance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../overfit/bias_vs_variance_quiz_m2_03.html">
     ✅ Quiz M2.03
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overfit/overfit_wrap_up_quiz.html">
   🏁 Wrap-up quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overfit/overfit_take_away.html">
   Main take-away
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Hyperparameter tuning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tuning/parameter_tuning_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tuning/parameter_tuning_manual_index.html">
   Manual tuning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_manual.html">
     Set and get hyperparameters in scikit-learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_ex_02.html">
     📝 Exercise M3.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_sol_02.html">
     📃 Solution for Exercise M3.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tuning/parameter_tuning_manual_quiz_m3_01.html">
     ✅ Quiz M3.01
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tuning/parameter_tuning_automated_index.html">
   Automated tuning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_grid_search.html">
     Hyperparameter tuning by grid-search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_randomized_search.html">
     Hyperparameter tuning by randomized-search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_nested.html">
     Cross-validation and hyperparameter tuning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_ex_03.html">
     📝 Exercise M3.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_sol_03.html">
     📃 Solution for Exercise M3.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tuning/parameter_tuning_automated_quiz_m3_02.html">
     ✅ Quiz M3.02
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tuning/parameter_tuning_wrap_up_quiz.html">
   🏁 Wrap-up quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tuning/parameter_tuning_module_take_away.html">
   Main take-away
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../linear_models/linear_models_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../linear_models/linear_models_intuitions_index.html">
   Intuitions on linear models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/linear_models_slides.html">
     📰 Intuitions on linear models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/linear_models_quiz_m4_01.html">
     ✅ Quiz M4.01
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../linear_models/linear_models_regression_index.html">
   Linear regression
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_regression_without_sklearn.html">
     Linear regression without scikit-learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_ex_01.html">
     📝 Exercise M4.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_sol_01.html">
     📃 Solution for Exercise M4.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_regression_in_sklearn.html">
     Linear regression using scikit-learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/linear_models_quiz_m4_02.html">
     ✅ Quiz M4.02
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../linear_models/linear_models_non_linear_index.html">
   Modelling non-linear features-target relationships
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_ex_02.html">
     📝 Exercise M4.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_sol_02.html">
     📃 Solution for Exercise M4.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_regression_non_linear_link.html">
     Linear regression for a non-linear features-target relationship
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_ex_03.html">
     📝 Exercise M4.03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_sol_03.html">
     📃 Solution for Exercise M4.03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/linear_models_quiz_m4_03.html">
     ✅ Quiz M4.03
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../linear_models/linear_models_regularization_index.html">
   Regularization in linear model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/regularized_linear_models_slides.html">
     📰 Intuitions on regularized linear models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/linear_models_quiz_m4_04a.html">
     ✅ Quiz M4.04a
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_regularization.html">
     Regularization of linear regression model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_ex_04.html">
     📝 Exercise M4.04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_sol_04.html">
     📃 Solution for Exercise M4.04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/linear_models_quiz_m4_04b.html">
     ✅ Quiz M4.04b
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../linear_models/linear_models_classification_index.html">
   Linear model for classification
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="logistic_regression.html">
     Linear model for classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_ex_05.html">
     📝 Exercise M4.05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_sol_05.html">
     📃 Solution for Exercise M4.05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="logistic_regression_non_linear.html">
     Beyond linear separation in classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/linear_models_quiz_m4_05.html">
     ✅ Quiz M4.05
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linear_models/linear_models_wrap_up_quiz.html">
   🏁 Wrap-up quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linear_models/linear_models_module_take_away.html">
   Main take-away
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Decision tree models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../trees/trees_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../trees/trees_intuitions_index.html">
   Intuitions on tree-based models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../trees/slides.html">
     📰 Intuitions on tree-based models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../trees/trees_quiz_m5_01.html">
     ✅ Quiz M5.01
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../trees/trees_classification_index.html">
   Decision tree in classification
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_classification.html">
     Build a classification decision tree
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_ex_01.html">
     📝 Exercise M5.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_sol_01.html">
     📃 Solution for Exercise M5.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../trees/trees_quiz_m5_02.html">
     ✅ Quiz M5.02
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../trees/trees_regression_index.html">
   Decision tree in regression
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_regression.html">
     Decision tree for regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_ex_02.html">
     📝 Exercise M5.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_sol_02.html">
     📃 Solution for Exercise M5.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../trees/trees_quiz_m5_03.html">
     ✅ Quiz M5.03
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../trees/trees_hyperparameters_index.html">
   Hyperparameters of decision tree
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_hyperparameters.html">
     Importance of decision tree hyperparameters on generalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../trees/trees_quiz_m5_04.html">
     ✅ Quiz M5.04
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../trees/trees_wrap_up_quiz.html">
   🏁 Wrap-up quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../trees/trees_module_take_away.html">
   Main take-away
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Ensemble of models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ensemble/ensemble_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ensemble/ensemble_intuitions_index.html">
   Intuitions on ensemble methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ensemble/slides.html">
     📰 Intuitions on ensemble of tree-based models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ensemble/ensemble_quiz_m6_01.html">
     ✅ Quiz M6.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_introduction.html">
     Introductory example to ensemble models
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ensemble/ensemble_bootstrap_index.html">
   Ensemble method using bootstrapping
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_bagging.html">
     Bagging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_ex_01.html">
     📝 Exercise M6.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_sol_01.html">
     📃 Solution for Exercise M6.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_random_forest.html">
     Random forests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_ex_02.html">
     📝 Exercise M6.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_sol_02.html">
     📃 Solution for Exercise M6.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ensemble/ensemble_quiz_m6_02.html">
     ✅ Quiz M6.02
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ensemble/ensemble_boosting_index.html">
   Ensemble based on boosting
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_adaboost.html">
     Adaptive Boosting (AdaBoost)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_ex_03.html">
     📝 Exercise M6.03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_sol_03.html">
     📃 Solution for Exercise M6.03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_gradient_boosting.html">
     Gradient-boosting decision tree (GBDT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_ex_04.html">
     📝 Exercise M6.04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_sol_04.html">
     📃 Solution for Exercise M6.04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_hist_gradient_boosting.html">
     Speeding-up gradient-boosting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ensemble/ensemble_quiz_m6_03.html">
     ✅ Quiz M6.03
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ensemble/ensemble_hyperparameters_index.html">
   Hyperparameter tuning with ensemble methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
  <label for="toctree-checkbox-21">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_hyperparameters.html">
     Hyperparameter tuning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_ex_05.html">
     📝 Exercise M6.05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_sol_05.html">
     📃 Solution for Exercise M6.05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ensemble/ensemble_quiz_m6_04.html">
     ✅ Quiz M6.04
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ensemble/ensemble_wrap_up_quiz.html">
   🏁 Wrap-up quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ensemble/ensemble_module_take_away.html">
   Main take-away
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Evaluating model performance
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../evaluation/evaluation_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../evaluation/cross_validation_baseline_index.html">
   Comparing a model with simple baselines
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
  <label for="toctree-checkbox-22">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_baseline.html">
     Comparing results with baseline and chance level
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_ex_02.html">
     📝 Exercise M7.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_sol_02.html">
     📃 Solution for Exercise M7.01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../evaluation/evaluation_quiz_m7_01.html">
     ✅ Quiz M7.01
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../evaluation/cross_validation_choices_index.html">
   Choice of cross-validation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
  <label for="toctree-checkbox-23">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_ex_03.html">
     📝 Introductory exercise regarding stratification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_stratification.html">
     Stratification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_ex_04.html">
     📝 Introductory exercise for sample grouping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_grouping.html">
     Sample grouping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_ex_05.html">
     📝 Introductory exercise for non i.i.d. data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_time.html">
     Non i.i.d. data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../evaluation/evaluation_quiz_m7_02.html">
     ✅ Quiz M7.02
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../evaluation/cross_validation_nested_index.html">
   Nested cross-validation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
  <label for="toctree-checkbox-24">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_nested.html">
     Nested cross-validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../evaluation/evaluation_quiz_m7_03.html">
     ✅ Quiz M7.03
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../evaluation/02_metrics.html">
   Introduction of the evaluation metrics
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../evaluation/metrics_classification_index.html">
   Classification metrics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
  <label for="toctree-checkbox-25">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="metrics_classification.html">
     Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="metrics_ex_01.html">
     📝 Exercise M7.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="metrics_sol_01.html">
     📃 Solution for Exercise M7.02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../evaluation/evaluation_quiz_m7_04.html">
     ✅ Quiz M7.04
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../evaluation/metrics_regression_index.html">
   Regression metrics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
  <label for="toctree-checkbox-26">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="metrics_regression.html">
     Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="metrics_ex_02.html">
     📝 Exercise M7.03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="metrics_sol_02.html">
     📃 Solution for Exercise M7.03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../evaluation/evaluation_quiz_m7_05.html">
     ✅ Quiz M7.05
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../evaluation/evaluation_wrap_up_quiz.html">
   🏁 Wrap-up quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../evaluation/evaluation_module_take_away.html">
   Main take-away
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  🚧 Feature selection
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../feature_selection/feature_selection_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="feature_selection_introduction.html">
   Benefits of using feature selection
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../feature_selection/feature_selection_limitation_index.html">
   Caveats of feature selection
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
  <label for="toctree-checkbox-27">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="feature_selection_ex_01.html">
     📝 Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="feature_selection_sol_01.html">
     📃 Solution for Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="feature_selection_limitation_model.html">
     Limitation of selecting feature using a model
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../feature_selection/feature_selection_module_take_away.html">
   Main take-away
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../feature_selection/feature_selection_quiz.html">
   ✅ Quiz
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  🚧 Interpretation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dev_features_importance.html">
   Feature importance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interpretation/interpretation_quiz.html">
   ✅ Quiz
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../appendix/datasets_intro.html">
   Datasets description
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
  <label for="toctree-checkbox-28">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_dataset.html">
     The penguins datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../appendix/adult_census_description.html">
     The adult census dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="datasets_california_housing.html">
     The California housing dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="datasets_ames_housing.html">
     The Ames housing dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="datasets_blood_transfusion.html">
     The blood transfusion dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="datasets_bike_rides.html">
     The bike rides dataset
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/acknowledgement.html">
   Acknowledgement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/notebook_timings.html">
   Notebook timings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/toc_redirect.html">
   Table of contents
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/python_scripts/03_categorical_pipeline_column_transformer.py"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.py</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/INRIA/scikit-learn-mooc"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/INRIA/scikit-learn-mooc/issues/new?title=Issue%20on%20page%20%2Fpython_scripts/03_categorical_pipeline_column_transformer.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/INRIA/scikit-learn-mooc/edit/master/python_scripts/03_categorical_pipeline_column_transformer.py"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/INRIA/scikit-learn-mooc/master?urlpath=tree/python_scripts/03_categorical_pipeline_column_transformer.py"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selection-based-on-data-types">
   Selection based on data types
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dispatch-columns-to-a-specific-processor">
   Dispatch columns to a specific processor
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-of-the-model-with-cross-validation">
   Evaluation of the model with cross-validation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fitting-a-more-powerful-model">
   Fitting a more powerful model
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="using-numerical-and-categorical-variables-together">
<h1>Using numerical and categorical variables together<a class="headerlink" href="#using-numerical-and-categorical-variables-together" title="Permalink to this headline">¶</a></h1>
<p>In the previous notebooks, we showed the required preprocessing to apply
when dealing with numerical and categorical variables. However, we decoupled
the process to treat each type individually. In this notebook, we will show
how to combine these preprocessing steps.</p>
<p>We will first load the entire adult census dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">adult_census</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/adult-census.csv&quot;</span><span class="p">)</span>
<span class="c1"># drop the duplicated column `&quot;education-num&quot;` as stated in the first notebook</span>
<span class="n">adult_census</span> <span class="o">=</span> <span class="n">adult_census</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;education-num&quot;</span><span class="p">)</span>

<span class="n">target_name</span> <span class="o">=</span> <span class="s2">&quot;class&quot;</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">adult_census</span><span class="p">[</span><span class="n">target_name</span><span class="p">]</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">adult_census</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">target_name</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="selection-based-on-data-types">
<h2>Selection based on data types<a class="headerlink" href="#selection-based-on-data-types" title="Permalink to this headline">¶</a></h2>
<p>We will separate categorical and numerical variables using their data
types to identify them, as we saw previously that <code class="docutils literal notranslate"><span class="pre">object</span></code> corresponds
to categorical columns (strings). We make use of <code class="docutils literal notranslate"><span class="pre">make_column_selector</span></code>
helper to select the corresponding columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">make_column_selector</span> <span class="k">as</span> <span class="n">selector</span>

<span class="n">numerical_columns_selector</span> <span class="o">=</span> <span class="n">selector</span><span class="p">(</span><span class="n">dtype_exclude</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="n">categorical_columns_selector</span> <span class="o">=</span> <span class="n">selector</span><span class="p">(</span><span class="n">dtype_include</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>

<span class="n">numerical_columns</span> <span class="o">=</span> <span class="n">numerical_columns_selector</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">categorical_columns</span> <span class="o">=</span> <span class="n">categorical_columns_selector</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Here, we know that <code class="docutils literal notranslate"><span class="pre">object</span></code> data type is used to represent strings and thus
categorical features. Be aware that this is not always the case. Sometimes
<code class="docutils literal notranslate"><span class="pre">object</span></code> data type could contain other types of information, such as dates that
were not properly formatted (strings) and yet relate to a quantity of
elapsed  time.</p>
<p>In a more general scenario you should manually introspect the content of your
dataframe not to wrongly use <code class="docutils literal notranslate"><span class="pre">make_column_selector</span></code>.</p>
</div>
</div>
<div class="section" id="dispatch-columns-to-a-specific-processor">
<h2>Dispatch columns to a specific processor<a class="headerlink" href="#dispatch-columns-to-a-specific-processor" title="Permalink to this headline">¶</a></h2>
<p>In the previous sections, we saw that we need to treat data differently
depending on their nature (i.e. numerical or categorical).</p>
<p>Scikit-learn provides a <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> class which will send specific
columns to a specific transformer, making it easy to fit a single predictive
model on a dataset that combines both kinds of variables together
(heterogeneously typed tabular data).</p>
<p>We first define the columns depending on their data type:</p>
<ul class="simple">
<li><p><strong>one-hot encoding</strong> will be applied to categorical columns. Besides, we
use <code class="docutils literal notranslate"><span class="pre">handle_unknown=&quot;ignore&quot;</span></code> to solve the potential issues due to rare
categories.</p></li>
<li><p><strong>numerical scaling</strong> numerical features which will be standardized.</p></li>
</ul>
<p>Now, we create our <code class="docutils literal notranslate"><span class="pre">ColumnTransfomer</span></code> by specifying three values:
the preprocessor name, the transformer, and the columns.
First, let’s create the preprocessors for the numerical and categorical
parts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span>

<span class="n">categorical_preprocessor</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">numerical_preprocessor</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we create the transformer and associate each of these preprocessors
with their respective columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;one-hot-encoder&#39;</span><span class="p">,</span> <span class="n">categorical_preprocessor</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;standard_scaler&#39;</span><span class="p">,</span> <span class="n">numerical_preprocessor</span><span class="p">,</span> <span class="n">numerical_columns</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<p>We can take a minute to represent graphically the structure of a
<code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code>:</p>
<p><img alt="columntransformer diagram" src="../_images/api_diagram-columntransformer.svg" /></p>
<p>A <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> does the following:</p>
<ul class="simple">
<li><p>It <strong>splits the columns</strong> of the original dataset based on the column names
or indices provided. We will obtain as many subsets as the number of
transformers passed into the <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code>.</p></li>
<li><p>It <strong>transforms each subsets</strong>. A specific transformer is applied to
each subset: it will internally call <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code> or <code class="docutils literal notranslate"><span class="pre">transform</span></code>. The
output of this step is a set of transformed datasets.</p></li>
<li><p>It then <strong>concatenates the transformed datasets</strong> into a single dataset.</p></li>
</ul>
<p>The important thing is that <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> is like any other
scikit-learn transformer. In particular it can be combined with a classifier
in a <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We can display an interactive diagram with the following command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">set_config</span>
<span class="n">set_config</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="s1">&#39;diagram&#39;</span><span class="p">)</span>
<span class="n">model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f {color: black;background-color: white;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f pre{padding: 0;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-toggleable {background-color: white;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-estimator:hover {background-color: #d4ebff;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-item {z-index: 1;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-parallel-item:only-child::after {width: 0;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f div.sk-container {display: inline-block;position: relative;}</style><div id="sk-8a09b5a5-a2c2-4a9a-affc-0ae982e0ee8f" class"sk-top-container"><div class="sk-container"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="ba7870f9-a88d-4831-a175-1e936d62f3d6" type="checkbox" ><label class="sk-toggleable__label" for="ba7870f9-a88d-4831-a175-1e936d62f3d6">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('columntransformer',
                 ColumnTransformer(transformers=[('one-hot-encoder',
                                                  OneHotEncoder(handle_unknown='ignore'),
                                                  ['workclass', 'education',
                                                   'marital-status',
                                                   'occupation', 'relationship',
                                                   'race', 'sex',
                                                   'native-country']),
                                                 ('standard_scaler',
                                                  StandardScaler(),
                                                  ['age', 'capital-gain',
                                                   'capital-loss',
                                                   'hours-per-week'])])),
                ('logisticregression', LogisticRegression(max_iter=500))])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="442d54db-ca78-4483-8ddf-91a8922bffd6" type="checkbox" ><label class="sk-toggleable__label" for="442d54db-ca78-4483-8ddf-91a8922bffd6">columntransformer: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[('one-hot-encoder',
                                 OneHotEncoder(handle_unknown='ignore'),
                                 ['workclass', 'education', 'marital-status',
                                  'occupation', 'relationship', 'race', 'sex',
                                  'native-country']),
                                ('standard_scaler', StandardScaler(),
                                 ['age', 'capital-gain', 'capital-loss',
                                  'hours-per-week'])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="a7ec8464-0784-4131-8a46-721edf909b40" type="checkbox" ><label class="sk-toggleable__label" for="a7ec8464-0784-4131-8a46-721edf909b40">one-hot-encoder</label><div class="sk-toggleable__content"><pre>['workclass', 'education', 'marital-status', 'occupation', 'relationship', 'race', 'sex', 'native-country']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="79193a87-470c-46fa-94ae-5b08aba73b65" type="checkbox" ><label class="sk-toggleable__label" for="79193a87-470c-46fa-94ae-5b08aba73b65">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(handle_unknown='ignore')</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="d3ff9298-d9cc-4277-875f-45ff4a8548ff" type="checkbox" ><label class="sk-toggleable__label" for="d3ff9298-d9cc-4277-875f-45ff4a8548ff">standard_scaler</label><div class="sk-toggleable__content"><pre>['age', 'capital-gain', 'capital-loss', 'hours-per-week']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="f217e0d1-16cd-41a9-946d-862905ed6a4b" type="checkbox" ><label class="sk-toggleable__label" for="f217e0d1-16cd-41a9-946d-862905ed6a4b">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="630c6f62-1a7e-4f7d-b992-00c2c95205b7" type="checkbox" ><label class="sk-toggleable__label" for="630c6f62-1a7e-4f7d-b992-00c2c95205b7">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression(max_iter=500)</pre></div></div></div></div></div></div></div></div></div>
</div>
<p>The final model is more complex than the previous models but still follows
the same API (the same set of methods that can be called by the user):</p>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method is called to preprocess the data and then train the
classifier of the preprocessed data;</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method makes predictions on new data;</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">score</span></code> method is used to predict on the test data and compare the
predictions to the expected test labels to compute the accuracy.</p></li>
</ul>
<p>Let’s start by splitting our data into train and test sets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">data_train</span><span class="p">,</span> <span class="n">data_test</span><span class="p">,</span> <span class="n">target_train</span><span class="p">,</span> <span class="n">target_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Be aware that we use <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code> here for didactic purposes, to show
the scikit-learn API.</p>
</div>
<p>Now, we can train the model on the train set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_train</span><span class="p">,</span> <span class="n">target_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then, we can send the raw dataset straight to the pipeline. Indeed, we do not
need to make any manual preprocessing (calling the <code class="docutils literal notranslate"><span class="pre">transform</span></code> or
<code class="docutils literal notranslate"><span class="pre">fit_transform</span></code> methods) as it will be handled when calling the <code class="docutils literal notranslate"><span class="pre">predict</span></code>
method. As an example, we predict on the five first samples from the test
set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>education</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7762</th>
      <td>56</td>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Divorced</td>
      <td>Other-service</td>
      <td>Unmarried</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
    </tr>
    <tr>
      <th>23881</th>
      <td>25</td>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Married-civ-spouse</td>
      <td>Transport-moving</td>
      <td>Own-child</td>
      <td>Other</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
    </tr>
    <tr>
      <th>30507</th>
      <td>43</td>
      <td>Private</td>
      <td>Bachelors</td>
      <td>Divorced</td>
      <td>Prof-specialty</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Female</td>
      <td>14344</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
    </tr>
    <tr>
      <th>28911</th>
      <td>32</td>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Married-civ-spouse</td>
      <td>Transport-moving</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
    </tr>
    <tr>
      <th>19484</th>
      <td>39</td>
      <td>Private</td>
      <td>Bachelors</td>
      <td>Married-civ-spouse</td>
      <td>Sales</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>30</td>
      <td>United-States</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_test</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39; &lt;=50K&#39;, &#39; &lt;=50K&#39;, &#39; &gt;50K&#39;, &#39; &lt;=50K&#39;, &#39; &gt;50K&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_test</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7762      &lt;=50K
23881     &lt;=50K
30507      &gt;50K
28911     &lt;=50K
19484     &lt;=50K
Name: class, dtype: object
</pre></div>
</div>
</div>
</div>
<p>To get directly the accuracy score, we need to call the <code class="docutils literal notranslate"><span class="pre">score</span></code> method. Let’s
compute the accuracy score on the entire test set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_test</span><span class="p">,</span> <span class="n">target_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8575055278028008
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluation-of-the-model-with-cross-validation">
<h2>Evaluation of the model with cross-validation<a class="headerlink" href="#evaluation-of-the-model-with-cross-validation" title="Permalink to this headline">¶</a></h2>
<p>As previously stated, a predictive model should be evaluated by
cross-validation. Our model is usable with the cross-validation tools of
scikit-learn as any other predictors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>

<span class="n">cv_results</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;fit_time&#39;: array([1.03213048, 0.99996662, 0.9242239 , 0.99543667, 0.99995995]),
 &#39;score_time&#39;: array([0.04144073, 0.04017544, 0.04004979, 0.04194117, 0.0401423 ]),
 &#39;test_score&#39;: array([0.8512642 , 0.8498311 , 0.84756347, 0.8523751 , 0.85503686])}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="s2">&quot;test_score&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The mean cross-validation accuracy is: &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The mean cross-validation accuracy is: 0.851 +/- 0.002
</pre></div>
</div>
</div>
</div>
<p>The compound model has a higher predictive accuracy than the two models that
used numerical and categorical variables in isolation.</p>
</div>
<div class="section" id="fitting-a-more-powerful-model">
<h2>Fitting a more powerful model<a class="headerlink" href="#fitting-a-more-powerful-model" title="Permalink to this headline">¶</a></h2>
<p><strong>Linear models</strong> are nice because they are usually cheap to train,
<strong>small</strong> to deploy, <strong>fast</strong> to predict and give a <strong>good baseline</strong>.</p>
<p>However, it is often useful to check whether more complex models such as an
ensemble of decision trees can lead to higher predictive performance. In this
section we will use such a model called <strong>gradient-boosting trees</strong> and
evaluate its generalization performance. More precisely, the scikit-learn model
we will use is called <code class="docutils literal notranslate"><span class="pre">HistGradientBoostingClassifier</span></code>. Note that boosting
models will be covered in more detail in a future module.</p>
<p>For tree-based models, the handling of numerical and categorical variables is
simpler than for linear models:</p>
<ul class="simple">
<li><p>we do <strong>not need to scale the numerical features</strong></p></li>
<li><p>using an <strong>ordinal encoding for the categorical variables</strong> is fine even if
the encoding results in an arbitrary ordering</p></li>
</ul>
<p>Therefore, for <code class="docutils literal notranslate"><span class="pre">HistGradientBoostingClassifier</span></code>, the preprocessing pipeline
is slightly simpler than the one we saw earlier for the <code class="docutils literal notranslate"><span class="pre">LogisticRegression</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">HistGradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OrdinalEncoder</span>

<span class="n">categorical_preprocessor</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s2">&quot;use_encoded_value&quot;</span><span class="p">,</span>
                                          <span class="n">unknown_value</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;categorical&#39;</span><span class="p">,</span> <span class="n">categorical_preprocessor</span><span class="p">,</span> <span class="n">categorical_columns</span><span class="p">)],</span>
    <span class="n">remainder</span><span class="o">=</span><span class="s2">&quot;passthrough&quot;</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">preprocessor</span><span class="p">,</span> <span class="n">HistGradientBoostingClassifier</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we created our model, we can check its generalization performance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_train</span><span class="p">,</span> <span class="n">target_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 853 ms, sys: 0 ns, total: 853 ms
Wall time: 853 ms
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_test</span><span class="p">,</span> <span class="n">target_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8792891655065105
</pre></div>
</div>
</div>
</div>
<p>We can observe that we get significantly higher accuracies with the Gradient
Boosting model. This is often what we observe whenever the dataset has a
large number of samples and limited number of informative features (e.g. less
than 1000) with a mix of numerical and categorical variables.</p>
<p>This explains why Gradient Boosted Machines are very popular among
datascience practitioners who work with tabular data.</p>
<p>In this notebook we:</p>
<ul class="simple">
<li><p>used a <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> to apply different preprocessing for
categorical and numerical variables;</p></li>
<li><p>used a pipeline to chain the <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> preprocessing and
logistic regression fitting;</p></li>
<li><p>saw that <strong>gradient boosting methods</strong> can outperform <strong>linear
models</strong>.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./python_scripts"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_categorical_pipeline_sol_01.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">📃 Solution for Exercise M1.04</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="03_categorical_pipeline_ex_02.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">📝 Exercise M1.05</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By scikit-learn developers<br/>
        
            &copy; Copyright 2021.<br/>
          <div class="extra_footer">
            <div>
   <a href="https://www.fun-mooc.fr/en/courses/machine-learning-python-scikit-learn">Register</a>
  and get the full "Machine learning in Python with scikit-learn" MOOC experience!</br>
  Brought to you by
  <a href="https://learninglab.inria.fr">Inria Learning Lab</a>,
  <a href="https://scikit-learn.fondation-inria.fr">scikit-learn @ La Fondation Inria</a>,
  <a href="https://www.inria-academy.fr/formation/scikit-learn-la-boite-a-outils-de-lapprentissage-automatique/">Inria Academy</a>,
  with many thanks to the <a href="https://scikit-learn.org">scikit-learn</a> community as a whole!
</div>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>