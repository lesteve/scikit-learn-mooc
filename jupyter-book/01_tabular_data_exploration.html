
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Loading data into machine learning &#8212; Scikit-learn tutorial</title>
    
  <link rel="stylesheet" href="_static/css/index.d431a4ee1c1efae0e38bdfebc22debff.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.bfb7730f9caf2ec0b46a44615585038c.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.30270b6e4c972e43c488.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="First model with scikit-learn" href="02_basic_preprocessing.html" />
    <link rel="prev" title="Intro" href="index.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/scikit-learn-logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scikit-learn tutorial</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <p class="caption">
 <span class="caption-text">
  Tabular data exploration
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Loading data into machine learning
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Fitting a scikit-learn model on numerical data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="02_basic_preprocessing.html">
   First model with scikit-learn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_basic_preprocessing_exercise_01.html">
   Exercise 01
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_basic_preprocessing_exercise_01_solution.html">
   Solution for Exercise 01
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Fitting a scikit-learn model on numerical data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="03_basic_preprocessing_categorical_variables.html">
   Working with both numerical &amp; categorical variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_basic_preprocessing_categorical_variables.html#fitting-a-more-powerful-model">
   Fitting a more powerful model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_basic_preprocessing_categorical_variables_exercise_01.html">
   Exercise 02
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_basic_preprocessing_categorical_variables_exercise_01_solution.html">
   Solution for Exercise 02
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_basic_preprocessing_categorical_variables_exercise_02.html">
   Exercise 03
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_basic_preprocessing_categorical_variables_exercise_02_solution.html">
   Solution for Exercise 03
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Parameter tuning
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="04_basic_parameters_tuning.html">
   Introduction to scikit-learn: basic model hyper-parameters tuning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_basic_parameters_tuning_exercise_01.html">
   Exercise 01
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_basic_parameters_tuning_exercise_01_solution.html">
   Exercise 01
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_basic_parameters_tuning_exercise_02.html">
   Exercise 02
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_basic_parameters_tuning_exercise_02_solution.html">
   Exercise 02
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Linear models
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   Linear Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html#main-take-away">
   Main take away
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Decision Trees
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="trees.html">
   Decision tree in depth
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Ensemble models
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="ensemble.html">
   Ensemble learning: when many are better that the one
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Metrics
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="metrics.html">
   Evaluation of your predictive model
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Interpretation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="dev_features_importance.html">
   Feature importance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dev_features_importance.html#take-away">
   Take Away
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/01_tabular_data_exploration.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/01_tabular_data_exploration.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/INRIA/scikit-learn-mooc/master?urlpath=tree/python_scripts/01_tabular_data_exploration.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-the-adult-census-dataset">
   Loading the adult census dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-variables-columns-in-the-dataset">
   The variables (columns) in the dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visual-inspection-of-the-data">
   Visual inspection of the data
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="loading-data-into-machine-learning">
<h1>Loading data into machine learning<a class="headerlink" href="#loading-data-into-machine-learning" title="Permalink to this headline">¶</a></h1>
<p>In this notebook, we will look at the necessary steps required before any machine learning takes place.</p>
<ul class="simple">
<li><p>load the data</p></li>
<li><p>look at the variables in the dataset, in particular, differentiate
between numerical and categorical variables, which need different
preprocessing in most machine learning workflows</p></li>
<li><p>visualize the distribution of the variables to gain some insights into the dataset</p></li>
</ul>
<div class="section" id="loading-the-adult-census-dataset">
<h2>Loading the adult census dataset<a class="headerlink" href="#loading-the-adult-census-dataset" title="Permalink to this headline">¶</a></h2>
<p>We will use data from the “Current Population adult_census” from 1994 that we
downloaded from <a class="reference external" href="http://openml.org/">OpenML</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">adult_census</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/adult-census.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can look at the OpenML webpage to learn more about this dataset: http://www.openml.org/d/1590</p>
<p>The goal with this data is to predict whether a person earns over 50K a year
from heterogeneous data such as age, employment, education, family
information, etc.</p>
</div>
<div class="section" id="the-variables-columns-in-the-dataset">
<h2>The variables (columns) in the dataset<a class="headerlink" href="#the-variables-columns-in-the-dataset" title="Permalink to this headline">¶</a></h2>
<p>The data are stored in a pandas dataframe.</p>
<p>Pandas is a Python library to manipulate tables, a bit like Excel but programming: https://pandas.pydata.org/</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">adult_census</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1"># Look at the first few lines of our dataframe</span>
</pre></div>
</div>
</div>
</div>
<p>The column named <strong>class</strong> is our target variable (i.e., the variable which
we want to predict). The two possible classes are <code class="docutils literal notranslate"><span class="pre">&lt;=</span> <span class="pre">50K</span></code> (low-revenue) and
<code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">50K</span></code> (high-revenue). The resulting prediction problem is therefore a binary
classification problem,
while we will use the other columns as input variables for our model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">target_column</span> <span class="o">=</span> <span class="s1">&#39;class&#39;</span>
<span class="n">adult_census</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Note: classes are slightly imbalanced. Class imbalance happens often in
practice and may need special techniques for machine learning. For example in
a medical setting, if we are trying to predict whether patients will develop
a rare disease, there will be a lot more healthy patients than ill patients in
the dataset.</p>
<p>The dataset contains both numerical and categorical data. Numerical values
can take continuous values for example <code class="docutils literal notranslate"><span class="pre">age</span></code>. Categorical values can have a
finite number of values, for example <code class="docutils literal notranslate"><span class="pre">native-country</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numerical_columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">,</span> <span class="s1">&#39;capital-gain&#39;</span><span class="p">,</span> <span class="s1">&#39;capital-loss&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hours-per-week&#39;</span><span class="p">]</span>
<span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span>
    <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;native-country&#39;</span><span class="p">]</span>
<span class="n">all_columns</span> <span class="o">=</span> <span class="n">numerical_columns</span> <span class="o">+</span> <span class="n">categorical_columns</span> <span class="o">+</span> <span class="p">[</span>
    <span class="n">target_column</span><span class="p">]</span>

<span class="n">adult_census</span> <span class="o">=</span> <span class="n">adult_census</span><span class="p">[</span><span class="n">all_columns</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Note that for simplicity, we have ignored the “fnlwgt” (final weight) column
that was crafted by the creators of the dataset when sampling the dataset to
be representative of the full census database.</p>
<p>We can check the number of samples and the number of features available in
the dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The dataset contains </span><span class="si">{</span><span class="n">adult_census</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> samples and &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">adult_census</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> features&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="visual-inspection-of-the-data">
<h2>Visual inspection of the data<a class="headerlink" href="#visual-inspection-of-the-data" title="Permalink to this headline">¶</a></h2>
<p>Before building a machine learning model, it is a good idea to look at the
data:</p>
<ul class="simple">
<li><p>maybe the task you are trying to achieve can be solved without machine
learning</p></li>
<li><p>you need to check that the information you need for your task is indeed present in
the dataset</p></li>
<li><p>inspecting the data is a good way to find peculiarities. These can
arise during data collection (for example, malfunctioning sensor or missing
values), or from the way the data is processed afterwards (for example capped
values).</p></li>
</ul>
<p>Let’s look at the distribution of individual variables, to get some insights
about the data. We can start by plotting histograms, note that this only
works for numerical variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">adult_census</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We can already make a few comments about some of the variables:</p>
<ul class="simple">
<li><p>age: there are not that many points for ‘age &gt; 70’. The dataset description
does indicate that retired people have been filtered out (<code class="docutils literal notranslate"><span class="pre">hours-per-week</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>).</p></li>
<li><p>education-num: peak at 10 and 13, hard to tell what it corresponds to
without looking much further. We’ll do that later in this notebook.</p></li>
<li><p>hours per week peaks at 40, this was very likely the standard number of
working hours at the time of the data collection</p></li>
<li><p>most values of capital-gain and capital-loss are close to zero</p></li>
</ul>
<p>For categorical variables, we can look at the distribution of values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">adult_census</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">adult_census</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pandas_profiling</span></code> is a nice tool for inspecting the data (both numerical and
categorical variables).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas_profiling</span>
<span class="n">adult_census</span><span class="o">.</span><span class="n">profile_report</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>As noted above, <code class="docutils literal notranslate"><span class="pre">education-num</span></code> distribution has two clear peaks around 10
and 13. It would be reasonable to expect that <code class="docutils literal notranslate"><span class="pre">education-num</span></code> is the number of
years of education.</p>
<p>Let’s look at the relationship between <code class="docutils literal notranslate"><span class="pre">education</span></code> and <code class="docutils literal notranslate"><span class="pre">education-num</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">adult_census</span><span class="p">[</span><span class="s1">&#39;education&#39;</span><span class="p">],</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">adult_census</span><span class="p">[</span><span class="s1">&#39;education-num&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>This shows that education and education-num gives you the same information.
For example, <code class="docutils literal notranslate"><span class="pre">education-num=2</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">education='1st-4th'</span></code>. In
practice that means we can remove <code class="docutils literal notranslate"><span class="pre">education-num</span></code> without losing information.
Note that having redundant (or highly correlated) columns can be a problem
for machine learning algorithms.</p>
<p>Another way to inspect the data is to do a pairplot and show how each variable
differs according to our target, <code class="docutils literal notranslate"><span class="pre">class</span></code>. Plots along the diagonal show the
distribution of individual variables for each <code class="docutils literal notranslate"><span class="pre">class</span></code>. The plots on the
off-diagonal can reveal interesting interactions between variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_samples_to_plot</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">,</span> <span class="s1">&#39;hours-per-week&#39;</span><span class="p">]</span>

<span class="c1"># reset the plotting style</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">adult_census</span><span class="p">[:</span><span class="n">n_samples_to_plot</span><span class="p">],</span> <span class="nb">vars</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
                 <span class="n">hue</span><span class="o">=</span><span class="n">target_column</span><span class="p">,</span> <span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">},</span>
                 <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">diag_kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>By looking at the data you could infer some hand-written rules to predict the
class:</p>
<ul class="simple">
<li><p>if you are young (less than 25 year-old roughly), you are in the <code class="docutils literal notranslate"><span class="pre">&lt;=</span> <span class="pre">50K</span></code> class.</p></li>
<li><p>if you are old (more than 70 year-old roughly), you are in the <code class="docutils literal notranslate"><span class="pre">&lt;=</span> <span class="pre">50K</span></code> class.</p></li>
<li><p>if you work part-time (less than 40 hours roughly) you are in the <code class="docutils literal notranslate"><span class="pre">&lt;=</span> <span class="pre">50K</span></code> class.</p></li>
</ul>
<p>These hand-written rules could work reasonably well without the need for any
machine learning. Note however that it is not very easy to create rules for
the region <code class="docutils literal notranslate"><span class="pre">40</span> <span class="pre">&lt;</span> <span class="pre">hours-per-week</span> <span class="pre">&lt;</span> <span class="pre">60</span></code> and <code class="docutils literal notranslate"><span class="pre">30</span> <span class="pre">&lt;</span> <span class="pre">age</span> <span class="pre">&lt;</span> <span class="pre">70</span></code>. We can hope that
machine learning can help in this region. Also note that visualization can
help creating hand-written rules but is limited to 2 dimensions (maybe 3
dimensions), whereas machine learning models can build models in
high-dimensional spaces.</p>
<p>Another thing worth mentioning in this plot: if you are young (less than 25
year-old roughly) or old (more than 70 year-old roughly) you tend to work
less. This is a non-linear relationship between age and hours
per week. Linear machine learning models can only capture linear interactions, so
this may be a factor when deciding which model to chose.</p>
<p>In a machine-learning setting, an algorithm automatically
create the “rules” in order to make predictions on new data.</p>
<p>The plot below shows the rules of a simple model, called decision tree.
We will explain how this model works in a latter notebook, for now let us
just consider the model predictions when trained on this dataset:</p>
<p><img alt="" src="_images/simple_decision_tree_adult_census.png" /></p>
<p>The background color in each area represents the probability of the class
<code class="docutils literal notranslate"><span class="pre">high-income</span></code> as estimated by the model. Values towards 0 (dark blue)
indicates that the model predicts <code class="docutils literal notranslate"><span class="pre">low-income</span></code> with a high probability.
Values towards 1 (dark orange) indicates that the model predicts
<code class="docutils literal notranslate"><span class="pre">high-income</span></code> with a high probability. Values towards 0.5 (white) indicates
that the model is not very sure about its prediction.</p>
<p>Looking at the plot here is what we can gather:</p>
<ul class="simple">
<li><p>In the region <code class="docutils literal notranslate"><span class="pre">age</span> <span class="pre">&lt;</span> <span class="pre">28.5</span></code> (left region) the prediction is <code class="docutils literal notranslate"><span class="pre">low-income</span></code>. The
dark blue color indicates that the model is quite sure about its
prediction.</p></li>
<li><p>In the region <code class="docutils literal notranslate"><span class="pre">age</span> <span class="pre">&gt;</span> <span class="pre">28.5</span> <span class="pre">AND</span> <span class="pre">hours-per-week</span> <span class="pre">&lt;</span> <span class="pre">40.5</span></code>
(bottom-right region), the prediction is <code class="docutils literal notranslate"><span class="pre">low-income</span></code>. Note that the blue
is a bit lighter that for the left region which means that the algorithm is
not as certain in this region.</p></li>
<li><p>In the region <code class="docutils literal notranslate"><span class="pre">age</span> <span class="pre">&gt;</span> <span class="pre">28.5</span> <span class="pre">AND</span> <span class="pre">hours-per-week</span> <span class="pre">&gt;</span> <span class="pre">40.5</span></code> (top-right region),
the prediction is <code class="docutils literal notranslate"><span class="pre">low-income</span></code>. However the probability of the class
<code class="docutils literal notranslate"><span class="pre">low-income</span></code> is very close to 0.5 which means the model is not sure at all
about its prediction.</p></li>
</ul>
<p>It is interesting to see that a simple model create rules similar to the ones
that we could have created by hand. Note that machine learning is really
interesting when creating rules by hand is not straightfoward, for example
because we are in high dimension (many features) or because there is no
simple and obvious rules that separate the two classes as in the top-right
region</p>
<p>In this notebook we have:</p>
<ul class="simple">
<li><p>loaded the data from a CSV file using <code class="docutils literal notranslate"><span class="pre">pandas</span></code></p></li>
<li><p>looked at the differents kind of variables to differentiate
between categorical and numerical variables</p></li>
<li><p>inspected the data with <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> and <code class="docutils literal notranslate"><span class="pre">pandas_profiling</span></code>. Data inspection
can allow you to decide whether using machine learning is appropriate for
your data and to highlight potential peculiarities in your data</p></li>
</ul>
<p>Ideas which will be discussed more in details later:</p>
<ul class="simple">
<li><p>if your target variable is imbalanced (e.g., you have more samples from one
target category than another), you may need special techniques for training and
evaluating your machine learning model</p></li>
<li><p>having redundant (or highly correlated) columns can be a problem for
some machine learning algorithms</p></li>
<li><p>contrary to decision tree, linear models can only capture linear interaction, so be
aware of non-linear relationships in your data</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">Intro</a>
    <a class='right-next' id="next-link" href="02_basic_preprocessing.html" title="next page">First model with scikit-learn</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By scikit-learn developers<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.30270b6e4c972e43c488.js"></script>


    
  </body>
</html>